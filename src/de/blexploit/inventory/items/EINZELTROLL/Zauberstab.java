package de.blexploit.inventory.items.EINZELTROLL;

import org.bukkit.Material;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.block.Action;
import org.bukkit.event.player.PlayerInteractEvent;
import org.bukkit.inventory.ItemStack;

import de.blexploit.inventory.creator.Bereich;
import de.blexploit.inventory.creator.InvItem;
import de.blexploit.players.Getrollts;
import de.blexploit.players.create.GetrolltEntity;
import de.blexploit.players.create.MittrollerEntity;

public final class Zauberstab extends InvItem implements Listener {

	private final ItemStack Zauberstab = api.ItemStackBlex.create(Material.STICK, "§c*BITTE KLICKEN!*", "§eKlick mich bitte!",
			1);

	public Zauberstab() {
		super("Zauberstab", "Wer ihn anklickt Explodiert.;%Denn zaubern muss gelernt sein!", Material.STICK, 0,
				Bereich.EINZELTROLL, false);
	}

	@Override
	public void right_click(MittrollerEntity mt) {
		spielerInfo(mt, "verteilt den Stab der Warheit!");
		mt.getPlayer().getInventory().setItemInMainHand(null);

		for (GetrolltEntity gt : Getrollts.getOnlines()) {
			Player p = gt.getPlayer();
			p.getInventory().setItemInMainHand(Zauberstab);
			gt.sendMessage("§eDu hast einen Zauberstab erhalten, klicke um ihn zu benutzen!");
		}

	}

	@EventHandler
	private void Zauberstab_klick(PlayerInteractEvent e) {
		if (e.getAction() != Action.PHYSICAL) {
			Player p = e.getPlayer();
			if (!Getrollts.containsP(p)) {
				return;
			}
			if (p.getInventory().getItemInMainHand() != null) {
				if (p.getInventory().getItemInMainHand().equals(Zauberstab)) {
					p.getWorld().createExplosion(p.getLocation(), 30);
					p.getInventory().setItemInMainHand(null);
					p.setHealth(0D);
				}
			}
		}
	}

}
