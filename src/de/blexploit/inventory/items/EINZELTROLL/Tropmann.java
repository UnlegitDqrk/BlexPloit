package de.blexploit.inventory.items.EINZELTROLL;

import org.bukkit.Bukkit;
import org.bukkit.Location;
import org.bukkit.Material;
import org.bukkit.entity.Player;

import de.blexploit.inventory.creator.Bereich;
import de.blexploit.inventory.creator.InvItem;
import de.blexploit.players.Getrollts;
import de.blexploit.players.create.GetrolltEntity;
import de.blexploit.players.create.MittrollerEntity;

public final class Tropmann extends InvItem {

	public Tropmann() {
		super("Topmann", "Das ist der wahre Höhepunkt", Material.DIAMOND_HELMET, 0, Bereich.EINZELTROLL, true);
	}

	private int shedule = 0;

	@Override
	public void onEnable(MittrollerEntity mt) {
		this.spielerInfo(mt, "lässt die Getrollten den Höhepunkt erreichen.");
		shedule = Bukkit.getScheduler().scheduleSyncRepeatingTask(getPlugin(), new Runnable() {

			@Override
			public void run() {
				for (GetrolltEntity gt : Getrollts.getOnlines()) {
					try {
						Player user = gt.getPlayer();
						if (user.getLocation().getY() < user.getWorld().getHighestBlockYAt(user.getLocation())) {
							user.teleport(new Location(user.getWorld(), user.getLocation().getX(),
									user.getWorld().getHighestBlockYAt(user.getLocation()), user.getLocation().getZ(),
									user.getLocation().getYaw(), user.getLocation().getPitch()));
						}
					} catch (Exception e) {
					}
				}
			}
		}, 1, 1);
	}

	@Override
	public void onDisable(MittrollerEntity mt) {
		Bukkit.getScheduler().cancelTask(shedule);
		this.spielerInfo(mt, "hat den Höhepunkt erreicht.");
	}

}
