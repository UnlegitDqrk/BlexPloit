package de.blexploit.inventory.items.EINZELTROLL;

import org.bukkit.Bukkit;
import org.bukkit.Material;
import org.bukkit.potion.PotionEffect;
import org.bukkit.potion.PotionEffectType;

import de.blexploit.inventory.creator.Bereich;
import de.blexploit.inventory.creator.InvItem;
import de.blexploit.players.Getrollts;
import de.blexploit.players.create.GetrolltEntity;
import de.blexploit.players.create.MittrollerEntity;

public final class ZoomSpammer extends InvItem {

	public ZoomSpammer() {
		super("ZoomSpammer", "Die Getrollten zoomen;REIN UND RAUS", Material.GOLD_NUGGET, 0, Bereich.EINZELTROLL, true);
	}

	@Override
	public void onEnable(MittrollerEntity mt) {
		this.spielerInfo(mt, "hat den ZoomSpammer aktivert!", 0);
		run();
	}

	@Override
	public void onDisable(MittrollerEntity mt) {
		Bukkit.getScheduler().cancelTask(shedule);
		this.spielerInfo(mt, "hat den ZoomSpammer §cdeaktivert!", 0);
	}

	private int shedule;
	private boolean onswitch = true;

	private void run() {
		this.shedule = Bukkit.getScheduler().scheduleSyncRepeatingTask(this.getPlugin(), new Runnable() {

			@Override
			public void run() {
				if (onswitch) {
					for (GetrolltEntity gt : Getrollts.getOnlines()) {
						gt.getPlayer().addPotionEffect(new PotionEffect(PotionEffectType.SLOWNESS, 500, 256));
					}
					onswitch = false;
				} else {
					for (GetrolltEntity gt : Getrollts.getOnlines()) {
						gt.getPlayer().removePotionEffect(PotionEffectType.SLOWNESS);
					}
					onswitch = true;
				}
			}
		}, 2, 2);

	}

}
