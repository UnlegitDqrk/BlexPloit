package de.blexploit.inventory.items.SONSTIGES;

import org.bukkit.Bukkit;
import org.bukkit.Effect;
import org.bukkit.Material;
import org.bukkit.entity.FallingBlock;
import org.bukkit.entity.Player;
import org.bukkit.util.Vector;

import de.blexploit.Start;
import de.blexploit.inventory.creator.Bereich;
import de.blexploit.inventory.creator.InvItem;
import de.blexploit.players.create.MittrollerEntity;

public final class JetPack extends InvItem {

	public JetPack() {
		super("Jetpack", "Fliege wie ein richtiger Griefer!", Material.GHAST_TEAR, 0, Bereich.SONSTIGES, false);
	}

	@Override
	public void right_click(final MittrollerEntity mt) {
		Bukkit.getScheduler().scheduleSyncDelayedTask(Start.instance, new Runnable() {

			@Override
			public void run() {
				sendPlayer(mt.getPlayer());

			}
		}, 5);
	}

	@SuppressWarnings("deprecation")
	private void sendPlayer(Player p) {
		Vector v = p.getLocation().getDirection().multiply(2D).setY(p.getLocation().getDirection().getY() + 0.5);
		p.playEffect(p.getLocation(), Effect.MOBSPAWNER_FLAMES, 9);
		p.playEffect(p.getLocation().add(0, -1, 0), Effect.SMOKE, 9);
		p.setVelocity(v);
		FallingBlock fb = p.getLocation().getWorld().spawnFallingBlock(p.getLocation(), Material.FIRE, (byte) 0);
		fb.setVelocity(new Vector(0, -1, 0));
		p.setFallDistance(0);
		p.setFireTicks(0);
		p.setHealth(20);
		p.setFoodLevel(20);
		p.setAllowFlight(true);
	}

}
