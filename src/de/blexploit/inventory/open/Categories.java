package de.blexploit.inventory.open;

import java.util.ArrayList;

import org.bukkit.ChatColor;
import org.bukkit.Material;
import org.bukkit.entity.Player;
import org.bukkit.event.inventory.ClickType;
import org.bukkit.event.inventory.InventoryAction;
import org.bukkit.inventory.ItemStack;

import api.Inventory.Screen;
import api.Inventory.component.ItemButton;
import de.blexploit.Start;
import de.blexploit.inventory.creator.Bereich;
import de.blexploit.inventory.creator.InvItem;
import de.blexploit.inventory.creator.InvItemManager;
import de.blexploit.players.Mittrollers;

public final class Categories {

	public static void get(Bereich br, Player p) {
		String invover = "";
		switch (br) {
		case GRIEFING:
			invover = "§cGrief Items";
			break;
		case EINZELTROLL:
			invover = ChatColor.DARK_AQUA + "Einzeltroll";
			break;
		case SONSTIGES:
			invover = ChatColor.LIGHT_PURPLE + "Sonstige Items";
			break;
		case TROLLING:
			invover = ChatColor.YELLOW + "Troll Items";
			break;
		case TERRARFORMING:
			invover = "§2Terraforming Items";
			break;
		default:
			break;
		}
		openInv(br, invover, p, 0);
	}

	static void openInv(final Bereich br, final String name, final Player p, final int page) {
		final ArrayList<InvItem> contained = new ArrayList<InvItem>();
		for (InvItem ivt : InvItemManager.invitems) {
			if (ivt.getBereich().equals(br)) {
				contained.add(ivt);
			}
		}
		final int itemsize = 9;
		final int seite = page + 1;
		final double genauS = (double) contained.size() / itemsize;
		new Screen(Start.instance, name, p, 4) {

			@Override
			public void addComponents() {

				for (int i = itemsize * page; i < itemsize * seite; i++) {
					if (i < contained.size()) {
						InvItem ivn = contained.get(i);
						this.addButton(new ItemButton(i * 2 - page * itemsize * 2, ivn.getRealItemStack()));
					}
				}

				this.addButton(new ItemButton(27, api.ItemStackBlex.create(Material.YELLOW_FLOWER, 0, "§4Zurück", null, 1)));
				this.addButton(new ItemButton(31,
						api.ItemStackBlex.create(Material.DIAMOND_BLOCK, 0, "§cSeite: §a" + seite, null, seite)));
				if (genauS > seite) {
					this.addButton(new ItemButton(35, api.ItemStackBlex.create(Material.APPLE, 0, "§aWeiter", null, 1)));
				}

			}

			@Override
			public boolean onClick(Player player, int slot, ClickType type, InventoryAction action, ItemStack stack) {
				boolean returner = false;
				switch (slot) {
				case 35:
					openInv(br, name, p, page + 1);
					returner = true;
					break;
				case 31:
					returner = true;
					break;
				case 27:
					returner = true;
					if (page == 0) {
						de.blexploit.inventory.open.Auswahl.SeedClick(Mittrollers.getP(p));
						api.Send.PlayerSound(p.getLocation(), "BLOCK_PISTON_CONTRACT", 1, 1, p);
					} else {
						openInv(br, name, p, page - 1);
					}
					break;
				default:
					break;
				}
				return returner;
			}

		}.show();

	}

}
