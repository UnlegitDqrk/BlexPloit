package de.blexploit.command.cmds;

import org.bukkit.ChatColor;
import org.bukkit.entity.Player;

import api.Fehler;
import de.blexploit.command.Command;
import de.blexploit.manager.TabManager;
import de.blexploit.players.create.MittrollerEntity;

public final class Fakemsg extends Command {

	public Fakemsg() {
		super("fakemsg", "Simuliert eine private Nachricht von einem Spieler zu einem anderen", TabManager.INSERT_PLAYERNAME,
				TabManager.INSERT_PLAYERNAME, "Message");
		this.setShowingArgs("Absender", "Empfänger");
	}

	@Override
	public void run(final String[] args, final MittrollerEntity mt) {
		if (args.length > 3) {
			final Player absender = api.Get.victim(args, 1);
			final Player empfänger = api.Get.victim(args, 2);
			final String nachricht = api.Get.nextArgs(args, 3);
			if (empfänger == null || absender == null) {
				mt.fehler(Fehler.PLAYER_NOT_FOUND);
				return;
			}

			String color = "";
			if (absender.isOp()) {
				color = "§4";
			} else {
				color = "§c";
			}

			String toSend = ChatColor.GOLD + "[" + color + absender.getName() + ChatColor.GOLD + " -> " + ChatColor.RED
					+ "me" + ChatColor.GOLD + "] " + ChatColor.WHITE + nachricht;
			toSend = toSend.replace("&", "§");
			empfänger.sendMessage(toSend);
			this.SpielerInfo(mt,
					"hat §c" + empfänger.getName() + this.CHAT_COLOR + " diese Nachricht gesendet: §r" + toSend);
		} else {
			mt.fehler(Fehler.ARGUMENT_EXCEPTION);
			mt.benutze(this);
		}
	}
}
