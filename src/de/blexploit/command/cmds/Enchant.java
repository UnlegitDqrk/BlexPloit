package de.blexploit.command.cmds;

import org.bukkit.enchantments.Enchantment;
import org.bukkit.inventory.ItemStack;

import api.Fehler;
import de.blexploit.command.Command;
import de.blexploit.manager.TabManager;
import de.blexploit.players.create.MittrollerEntity;

public final class Enchant extends Command {

	public Enchant() {
		super("verzaubern", "Verzaubert das Item in der Hand mit allen Enchantments", TabManager.INSERT_NUMBER, null);
	}

	@Override
	public void run(String[] args, MittrollerEntity mt) {
		int eLevel = 100;
		if (args.length > 1) {
			try {
				eLevel = Integer.parseInt(args[1]);
			} catch (final NumberFormatException e) {
				mt.fehler(Fehler.NUMBER_FORMAT_EXCEPTION);
			}
		}
		if (eLevel > 16960 || eLevel < 1) {
			mt.fehler("Deine Zahl muss in diesem Bereich liegen: 1 - 16.960");
			return;
		}

		final ItemStack toEnchant = mt.getPlayer().getItemInHand();
		if (toEnchant != null) {
			for (final Enchantment em : Enchantment.values()) {
				if (em != null) {
					toEnchant.addUnsafeEnchantment(em, eLevel);
				}
			}
		} else {
			mt.fehler(Fehler.ITEM_IN_HAND_NULLPOINT);
		}
		mt.getPlayer().setItemInHand(toEnchant);
		mt.sendMessage("Dein Item wurde erfolgreich verzaubert!");
	}
}
